"use strict";$.support.cors=!0,$(function(){(function(){var a=$(".col-md-6").width();(function(){function c(b){var c=(j-1)*a;$("#screenBody").is(":animated")||("right"===b?e===j?(e=1,$("#scrollMoives .side-index").html(e),$("#screenBody").animate({left:0},500)):(e++,$("#scrollMoives .side-index").html(e),$("#screenBody").animate({left:"-="+a},500)):1===e?(e=j,$("#scrollMoives .side-index").html(e),$("#screenBody").animate({left:"-="+c},500)):(e--,$("#scrollMoives .side-index").html(e),$("#screenBody").animate({left:"+="+a},500)))}var d=($("#scrollMoives .panel"),$("#headerNow span")),e=1,f=$("#scrollMoives .slide-prev"),g=$("#scrollMoives .slide-next"),h=$("#scrollMoives .thumbnail"),i=h.length,j=Math.ceil(i/4);$("#scrollMoives .side-max").html(j),$("#screenBody").width(a*j);var k=h.outerWidth(!0)-h.outerWidth(),l=(a-4*k)/4;h.width(l),d.on("click",function(){var c=$(this).text(),f="/?galleryName="+encodeURIComponent(c);b(f,"GET",function(b){var f=b.data||[],g=f.movies,k=f.movies.length;if($("#headerNow a").attr("href","/movie/results?cat="+f._id+"&p=0").text(f.name),"即将上映"===c?d.text("正在上映"):d.text("即将上映"),k<h.length)$("#scrollMoives .thumbnail:gt("+(k-1)+")").remove();else if(k>h.length){for(var m=h.length;k>m;m++)$("#screenBody").append('<div class="thumbnail"><a href="" target="_blank"><img src="" alt="" /></a><div class="caption"><h5></h5><p><a class="btn btn-primary" href="" role="button">观看预告片</a></p></div></div>');$("#screenBody .thumbnail:gt("+(h.length-1)+")").width(l)}h=$("#scrollMoives .thumbnail"),i=h.length,j=Math.ceil(i/4),$("#scrollMoives .side-max").html(j),$("#screenBody").width(a*j);for(var n=0;n<h.length;n++)if(g[n]){$(h[n]).find("a").attr("href","/movie/"+g[n]._id),$(h[n]).find("h5").html(g[n].title);var o=$(h[n]).find("img");g[n].poster&&(g[n].poster.indexOf("http:")>-1?o.attr("src",g[n].poster).attr("alt",g[n].poster):o.attr("src","/upload/movie/"+g[n].poster).attr("alt",g[n].poster))}e>j&&(e=j,$("#scrollMoives .side-index").html(e),$("#screenBody").animate({left:-a*(e-1)},0))})}),g.on("click",function(){c("right")}),f.on("click",function(){c("left")});var m=setInterval(function(){c("right")},5e3);$("#scrollMoives").on("mouseover",function(){clearInterval(m)}).on("mouseout",function(){m=setInterval(function(){c("right")},5e3)})})();$("#fliterMovies .class-top").on("click","button",function(){if(!$(this).is(".btn-primary")){var a=$(this).html(),c="/?fliterName="+encodeURIComponent(a+"电影");b(c,"GET",function(a){if(null===a.data||0===a.data.movies.length)$("#classBody").html("");else{var b=a.data.movies,c=$("#classBody .thumbnail"),d=b.length-1;if(b.length<c.length)$("#fliterMovies .col-md-3:gt("+d+")").remove();else if(b.length>c.length)for(var e=c.length;e<b.length;e++)$("#classBody").append('<div class="col-md-3"><div class="thumbnail"><a href=""><img src="" alt="" /></a><div class="caption"><h5></h5></div></div></div>');c=$("#classBody .thumbnail");for(var f=0;f<c.length;f++)if(b[f]){$(c[f]).find("a").attr("href","/movie/"+b[f]._id),$(c[f]).find("h5").html(b[f].title);var g=$(c[f]).find("img");b[f].poster&&(b[f].poster.indexOf("http:")>-1?g.attr("src",b[f].poster).attr("alt",b[f].poster):g.attr("src","/upload/movie/"+b[f].poster).attr("alt",b[f].poster))}}}),$(this).addClass("btn-primary").removeClass("btn-default").parent().siblings().children().addClass("btn-default").removeClass("btn-primary")}});var b=(function(){var b=1,c=$("#galleryFrames .slide-prev"),d=$("#galleryFrames .slide-next"),e=$("#galleryFrames li").length,f=$("#galleryFrames ul"),g=$("#galleryFrames .slide-item");$("#galleryFrames .side-max").html(e-2),f.width(a*e),f.css("left",-a),g.width(a),d.on("click",function(){i("right")}),c.on("click",function(){i("left")});var h=setInterval(function(){i("right")},5e3);$("#galleryFrames").on("mouseover",function(){clearTimeout(h)}).on("mouseout",function(){h=setInterval(function(){i("right")},5e3)});var i=function(c){f.is(":animated")||("right"===c?(b++,$("#galleryFrames .side-index").html(b),f.animate({left:"-="+a},500),b===e-1&&(b=1,$("#galleryFrames .side-index").html(b),f.animate({left:-a+"px"},0))):(b--,$("#galleryFrames .side-index").html(b),f.animate({left:"+="+a},500),0===b&&(b=e-2,$("#galleryFrames .side-index").html(b),f.animate({left:-(a*(e-2))+"px"},0))))}}(),function(){var a=$("#citySearch"),c=$("#citiesList"),d=$("#citySug"),e=$("#citySug .city-suggestion-list"),f=$("#citySug .auto-tip"),g=$("#citySug input");c.outerWidth(a.width()+d.width()),a.children("span").on("click",function(){"none"===c.css("display")?c.css("display","block"):c.css("display","none")}),$(".cities-list-hd").on("click","li",function(){var a=$(this).attr("index");$(this).addClass("on").siblings().removeClass("on"),c.find(".cities-list-item").eq(a-1).addClass("active").siblings().removeClass("active")}),$("#citiesList .cities-list-item").on("click","a",function(){a.children("span").html($(this).html()),c.css("display","none"),g.val("")}),g.on("focus",function(){h(),c.css("display","none")}),g.keyup(function(a){h()}),e.on("mousedown","a",function(){g.val($(this).html()),e.css("display","none")}),g.on("blur",function(){e.css("display","none")});var h=function(){var c=a.children("span").text(),d=g.val(),h="/?cityName="+encodeURIComponent(c)+"&&search="+encodeURIComponent(d);b(h,"GET",function(a){var b=a||[];f.html("");for(var c=0;c<b.length;c++)f.append('<li><a href="javascript:;">'+b[c]+"</a></li>");e.css("display","block")})}}(),function(a,b,c){$.ajax({url:a,cache:!0,type:b,crossDomain:!0}).done(c)})})()});