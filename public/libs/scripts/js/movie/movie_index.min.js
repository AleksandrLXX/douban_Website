"use strict";$.support.cors=!0,$(function(){function a(a,b,c){$.ajax({url:a,cache:!0,type:b,crossDomain:!0}).done(c)}(function(){var b=$(".col-md-6").width();(function(){function c(a){var c=(j-1)*b;$("#screenBody").is(":animated")||("right"===a?e===j?(e=1,$("#scrollMoives .side-index").html(e),$("#screenBody").animate({left:0},500)):(e++,$("#scrollMoives .side-index").html(e),$("#screenBody").animate({left:"-="+b},500)):1===e?(e=j,$("#scrollMoives .side-index").html(e),$("#screenBody").animate({left:"-="+c},500)):(e--,$("#scrollMoives .side-index").html(e),$("#screenBody").animate({left:"+="+b},500)))}var d=($("#scrollMoives .panel"),$("#headerNow span")),e=1,f=$("#scrollMoives .slide-prev"),g=$("#scrollMoives .slide-next"),h=$("#scrollMoives .thumbnail"),i=h.length,j=Math.ceil(i/4);$("#scrollMoives .side-max").html(j),$("#screenBody").width(b*j);var k=h.outerWidth(!0)-h.outerWidth(),l=(b-4*k)/4;h.width(l),d.on("click",function(){var c=$(this).text(),f="/?galleryName="+encodeURIComponent(c);a(f,"GET",function(a){var f=a.data||[],g=f.movies,k=f.movies.length;if($("#headerNow a").attr("href","/movie/results?cat="+f._id+"&p=0").text(f.name),"即将上映"===c?d.text("正在上映"):d.text("即将上映"),k<h.length)$("#scrollMoives .thumbnail:gt("+(k-1)+")").remove();else if(k>h.length){for(var m=h.length;k>m;m++)$("#screenBody").append('<div class="thumbnail"><a href="" target="_blank"><img src="" alt="" /></a><div class="caption"><h5></h5><p><a class="btn btn-primary" href="" role="button">观看预告片</a></p></div></div>');$("#screenBody .thumbnail:gt("+(h.length-1)+")").width(l)}h=$("#scrollMoives .thumbnail"),i=h.length,j=Math.ceil(i/4),$("#scrollMoives .side-max").html(j),$("#screenBody").width(b*j);for(var n=0;n<h.length;n++)if(g[n]){$(h[n]).find("a").attr("href","/movie/"+g[n]._id),$(h[n]).find("h5").html(g[n].title);var o=$(h[n]).find("img");g[n].poster&&(g[n].poster.indexOf("http:")>-1?o.attr("src",g[n].poster).attr("alt",g[n].poster):o.attr("src","/upload/movie/"+g[n].poster).attr("alt",g[n].poster))}e>j&&(e=j,$("#scrollMoives .side-index").html(e),$("#screenBody").animate({left:-b*(e-1)},0))})}),g.on("click",function(){c("right")}),f.on("click",function(){c("left")});var m=setInterval(function(){c("right")},5e3);$("#scrollMoives").on("mouseover",function(){clearInterval(m)}).on("mouseout",function(){m=setInterval(function(){c("right")},5e3)})})();$("#fliterMovies .class-top").on("click","button",function(){if(!$(this).is(".btn-primary")){var b=$(this).html(),c="/?fliterName="+encodeURIComponent(b+"电影");a(c,"GET",function(a){if(null===a.data||0===a.data.movies.length)$("#classBody").html("");else{var b=a.data.movies,c=$("#classBody .thumbnail"),d=b.length-1;if(b.length<c.length)$("#fliterMovies .col-md-3:gt("+d+")").remove();else if(b.length>c.length)for(var e=c.length;e<b.length;e++)$("#classBody").append('<div class="col-md-3"><div class="thumbnail"><a href=""><img src="" alt="" /></a><div class="caption"><h5></h5></div></div></div>');c=$("#classBody .thumbnail");for(var f=0;f<c.length;f++)if(b[f]){$(c[f]).find("a").attr("href","/movie/"+b[f]._id),$(c[f]).find("h5").html(b[f].title);var g=$(c[f]).find("img");b[f].poster&&(b[f].poster.indexOf("http:")>-1?g.attr("src",b[f].poster).attr("alt",b[f].poster):g.attr("src","/upload/movie/"+b[f].poster).attr("alt",b[f].poster))}}}),$(this).addClass("btn-primary").removeClass("btn-default").parent().siblings().children().addClass("btn-default").removeClass("btn-primary")}});(function(){function a(a){g.is(":animated")||("right"===a?(c++,$("#galleryFrames .side-index").html(c),g.animate({left:"-="+b},500),c===f-1&&(c=1,$("#galleryFrames .side-index").html(c),g.animate({left:-b+"px"},0))):(c--,$("#galleryFrames .side-index").html(c),g.animate({left:"+="+b},500),0===c&&(c=f-2,$("#galleryFrames .side-index").html(c),g.animate({left:-(b*(f-2))+"px"},0))))}var c=1,d=$("#galleryFrames .slide-prev"),e=$("#galleryFrames .slide-next"),f=$("#galleryFrames li").length,g=$("#galleryFrames ul"),h=$("#galleryFrames .slide-item");$("#galleryFrames .side-max").html(f-2),g.width(b*f),g.css("left",-b),h.width(b),e.on("click",function(){a("right")}),d.on("click",function(){a("left")});var i=setInterval(function(){a("right")},5e3);$("#galleryFrames").on("mouseover",function(){clearTimeout(i)}).on("mouseout",function(){i=setInterval(function(){a("right")},5e3)})})(),function(){function b(){var b=c.children("span").text(),d=h.val(),e="/?cityName="+encodeURIComponent(b)+"&&search="+encodeURIComponent(d);a(e,"GET",function(a){var b=a||[];g.html("");for(var c=0;c<b.length;c++)g.append('<li><a href="javascript:;">'+b[c]+"</a></li>");f.css("display","block")})}var c=$("#citySearch"),d=$("#citiesList"),e=$("#citySug"),f=$("#citySug .city-suggestion-list"),g=$("#citySug .auto-tip"),h=$("#citySug input");d.outerWidth(c.width()+e.width()),c.children("span").on("click",function(){"none"===d.css("display")?d.css("display","block"):d.css("display","none")}),$(".cities-list-hd").on("click","li",function(){var a=$(this).attr("index");$(this).addClass("on").siblings().removeClass("on"),d.find(".cities-list-item").eq(a-1).addClass("active").siblings().removeClass("active")}),$("#citiesList .cities-list-item").on("click","a",function(){c.children("span").html($(this).html()),d.css("display","none"),h.val("")}),h.on("focus",function(){b(),d.css("display","none")}),h.keyup(function(a){b()}),f.on("mousedown","a",function(){h.val($(this).html()),f.css("display","none")}),h.on("blur",function(){f.css("display","none")})}()})()});